<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h2 id="exact-solutions-to-the-nonlinear-dynamics-of-learning-in-deep-linear-neural-networks"><a href="http://arxiv.org/abs/1312.6120">Exact solutions to the nonlinear dynamics of learning in deep linear neural networks</a></h2>
<p><a href="http://arxiv.org/abs/1312.6120">Exact solutions to the nonlinear dynamics of learning in deep linear neural networks</a> Andrew M. Saxe, James L. McClelland, Surya Ganguli. arxiv (2013).</p>
<h4 id="key-points"><strong><em>Key Points</em></strong></h4>
<p>This work aims to start <strong><em>analyzing a gnawing question in machine learning</em></strong>:</p>
<p><span style="color:red"><strong><em>How do deep neural networks actually work</em></strong></span></p>
<p>In particular, for a given set of input-output pairs <span class="math inline">\(\{x^{\mu},y^{\mu}\}\)</span>, <strong><em>how do the network weights evolve[进化]</em></strong>, and how <strong><em>fast can the network converge</em></strong>?</p>
<p>To this end, the authors take a close look at the simplest form of deep networks, <span style="color:red"><strong><em>deep linear networks</em></strong></span>, and <strong><em>describe the dynamics on learning the network weights over time</em></strong>. While a simple case, the intuition[直觉] they build for the linear case gives the authors <span style="color:red"><strong><em>a way to discuss intelligent ways of initializing deep networks</em></strong></span>. The ensuing discussion about network initialization focuses on a kind of <span style="color:red"><strong><em>variance-invariance over network layers</em></strong></span>, a concept which the authors also discuss in the concept of nonlinear networks.</p>
<blockquote>
<p><strong><em>The paper is roughly divided into three sections:</em></strong></p>
</blockquote>
<ul>
<li>The first third of the paper discusses an <strong><em>exact analysis</em></strong> of the <strong><em>learning process for a linear neural network with one hidden layer</em></strong>.</li>
<li>The second third of this paper <strong><em>extends the ideas and intuition</em></strong> for a single hidden layer to networks with multiple hidden layers, and further develop the idea of <strong><em>greedy network initialization based on the network dynamics</em></strong>.</li>
<li>In the final section of the paper the authors look at the properties <strong><em>each of greedy and random network initialization</em></strong> and <strong><em>discuss the implications for learning rates in both linear and nonlinear networks</em></strong>.</li>
</ul>
<blockquote>
<p><strong><em>For the first third of the paper</em></strong></p>
</blockquote>
<p>the network being analyzed consists of:</p>
<ul>
<li><strong><em>input layer <span class="math inline">\(x\in\mathbb{R}^{N_1}\)</span></em></strong></li>
<li><strong><em>output layer <span class="math inline">\(y\in\mathbb{R}^{N_3}\)</span></em></strong></li>
<li><p><strong><em>hidden layer $h^{N_2} $</em></strong>.</p></li>
<li>The weights connecting layer <strong><em>one to layer two</em></strong> are <span class="math inline">\(W^{21} \in\mathbb{R}^{N_2,N_1}\)</span></li>
<li><p>The weights connecting layer <strong><em>two to layer three</em></strong> are <span class="math inline">\(W^{32} \in\mathbb{R}^{N_3,N_2}\)</span>.</p></li>
</ul>
<p>In a linear network the <strong><em>back-propagation learning rule</em></strong> simply projects the error of each training sample down the network. Taking the limit of small step sizes on the update rule and the expectation of the step with respect to the training set, <strong><em>the authors are able to write the learning rule as the set of differential equations</em></strong>:</p>
<p><span class="math display">\[\tau\frac{dW^{21}}{dt}={W^{32}}^T\left(\Sigma^{31}-W^{32}W^{21}\Sigma^{11}\right),\qquad\tau\frac{dW^{32}}{dt}=\left(\Sigma^{31}-W^{32}W^{21}\Sigma^{11}\right){W^{21}}^T ,\]</span></p>
<p>where <span class="math inline">\(\tau\)</span> is a constant, <span class="math inline">\(\Sigma^{11} = E[xx^T]\)</span> is the input covariance matrix and <span class="math inline">\(\Sigma^{31} = E[yx^T]\)</span> is the input-output cross-covariance matrix. <strong><em>To simplify the analysis</em></strong>, the authors <strong><em>assume appropriate whitening</em></strong> to at the input to set <span class="math inline">\(\Sigma^{11} = I\)</span> and replace <span class="math inline">\(\Sigma^{31}\)</span> with its SVD <span class="math inline">\(\Sigma^{31} = USV^T\)</span>.</p>
<p>This replacement allows the authors to analyze a simpler set of equations for an equivalent network that operates in the principal directions of <span class="math inline">\(\Sigma^{31}\)</span>.</p>
<p>This equivalent set of network weights can be written in terms of <span class="math inline">\(\overline{W}^{21} = W^{21}V = [a^1,a^2... a^\alpha, ... a^{N_2}]\)</span> and <span class="math inline">\(\overline{W}^{32} = UW^{32}= [b^1,b^2... b^\alpha, ... b^{N_2}]^T\)</span>.</p>
<p><strong><em>By writing an equivalent set of differential equations in terms of the a‘s and b‘s, we see an interesting phenomenon: the resulting equations essentially solve the cost function</em></strong>.</p>
<p><span class="math display">\[\frac{1}{2\tau}\left[ \sum_{\alpha} (s_\alpha - {a^\alpha}^T b^{\alpha})^2 + \sum_{\alpha\neq\beta}{a^\alpha}^T b^{\beta} \right]\]</span></p>
<p>This cost function is essentially saying that the <span class="math inline">\(\alpha^{th}\)</span> row-column couple <span class="math inline">\(\{a^\alpha,b^\alpha\}\)</span> is trying to represent the <span class="math inline">\(\alpha^{th}\)</span> mode of the cross covariance matrix <span class="math inline">\(s_\alpha\)</span>, while simultaneously trying to be as orthogonal as possible from all other sets of row-column pairs. <strong><em>For a typical matrix, this is essentially trying to find the best rank <span class="math inline">\(N_2\)</span> approximation to the cross covariance matrix (i.e. a dynamical system whose solution should be the SVD of <span class="math inline">\(\Sigma^{31}\)</span>)</em></strong>. The authors continue on to find closed form solutions for very simple cases of <span class="math inline">\(N_2 &lt; \min(N_1,N_2)\)</span> and <span class="math inline">\(a^{\alpha} = b^{\alpha} \propto r^{\alpha}\)</span> . While exact solutions for the values of proportionality are derived over time (i.e. the learning rate), the entire argument only holds for when <span class="math inline">\(r^{\alpha}\)</span> are pre-defined. Since these vectors cannot change naturally once initialized, I feel that a lot of the analysis would be difficult to move to a general case. Additionally, the analysis depends heavily on initializing the network to have orthogonal pairs of <span class="math inline">\(\{a,b\}\)</span>‘s: something that is impossible when the hidden layer is overcomplete: a common property of the oft-used convolutional neural networks. As such, the intuition built via this analysis allows the authors to continue onto deeper neural networks.</p>
<p>For deep neural networks, the mathematical details for reducing and analyzing the network learning dynamics becomes more complicated. To reduce the network analysis into an analysis of the rows and columns of a rotated set of weight matrices requires another set of rather stringent assumptions: that the right singular vectors of each weight matrix and match the left singular vectors of the weight matrix from the previous layer. Mathematically, if <span class="math inline">\(W^l = U^lS^l{V^l}^T\)</span>, then <span class="math inline">\(V^l = U^{l-1}\)</span>. The first and last set of weights are again modified via the left and right singular vectors of the input-output cross-covariance matrix. This additional assumption then allows them to again reduce the learning rules to an update on a set of proportionality variables (i.e. every layer has modes proportional to <span class="math inline">\(r^\alpha\)</span>). The authors then derive similar learning curves as in the single hidden layer case.</p>
<p>The authors also use <strong><em>the intuition from these analyses to discuss the virtues of greedy and random initialization of the network weights</em></strong>. For greedy methods they discuss a greedy method from the literature where the network is pre-trained in a two-step process. First, an auto-encoder is used to train the network to predict its own input. Second, the network is fine tuned to adapt to the desired output. The authors note that this procedure produces an input weight matrix proportional to the right singular vectors of the <span class="math inline">\(\Sigma^{31}\)</span>, meaning that the subspace chosen for the problem at hand is correct prior to learning. This implies that the subsequent learning will be very fast since the network does not need to adapt the principal directions, but rather only the strength of each layer.</p>
<p>As an alternative, the authors also discuss <strong><em>smarter random network initialization: using random orthogonal matrices over random Gaussian matrices</em></strong>. The intuition here comes from the fact that preservation of statistics across layers can imply faster learning. Alternatively, if a network layer does not preserve the total variance of the inputs from the previous layer, vital information could be lost either in terms of the lack of representation power at the output or by the lack of ability for gradients to effectively modify lower levels of the network. Gaussian matrices are particularly terrible in this regard since they are almost guaranteed to have many small singular values. This implies that many vectors, either coming up or down the network, will be severely attenuated, hindering learning. Random orthogonal matrices are guaranteed to preserve the norms of vectors, and consequently are invaluable in this regard. While interesting in its own right, this observation allows the authors to begin to talk about nonlinear networks. This is because the authors state that the greedy methods for initialization might not carry over well to the nonlinear case. In particular the greedy initialization observations depended on the relationship between the SVD of <span class="math inline">\(\Sigma^{31}\)</span>, which in turned was intuition gleaned from the update equations for linear networks. Nonlinear networks have a much more complex set of dynamics.</p>
<p><strong><em>Using the ideas of energy preservation and random orthogonal matrices</em></strong>, the authors discuss what it means for a nonlinear network to preserve information across network layers. To accomplish this, the authors present the concept of isometry called the dynamical isometry. Isometries in general discuss the preservation of distances across a function, and the dynamical isometry is particular to discussing the preservation of distances of the back-propagation functions in a deep network. Specifically, the authors describe DI as an isometry condition on the “product of Jacobians associated with error signal back-propagation”.</p>
<p>For linear networks, random orthogonal matrices automatically preserve the norms of vectors, so dynamical isometry follows directly. For nonlinear cases, the authors analyze networks with random orthogonal weights, tanh nonlinearities and a scaling factor g at each layer. The authors plot empirical distributions for the singular values of the Jacobian matrix as a function of the gain at each layer g and the strength of the input layer <span class="math inline">\(q = \frac{1}{N_1}\sum_i^{N_1} {x^1_i}^2\)</span>. For <span class="math inline">\(g&lt;1\)</span>, the singular values for the Jacobian are very small (less than 1% of the input variance) and therefore the network does not act as an isometry and learning will be slow. Similarly, when <span class="math inline">\(g\geq 1.1\)</span>, there are some large singular values, which look troubling to me. The authors mention that this condition is still better than random Gaussian weights. Right around <span class="math inline">\(g = 1\)</span> (what the authors term the “edge of chaos”) the singular values mostly cluster around one, indicating good learning properties.</p>
<p>Overall, I thought <strong><em>that this paper begins to ask the right questions about what properties of neural networks helps them learn</em></strong>. I’m a little skeptical that the analysis of the linear case will yield much for more general classes of networks actually in use, but I think the concepts that the authors are discussing are going to be very important. In particular, I’d be excited to see what comes of this dynamical isometry.</p>
</body>
</html>
