<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h2 id="all-you-need-is-a-good-init"><a href="http://arxiv.org/abs/1511.06422">ALL YOU NEED IS A GOOD INIT</a></h2>
<h3 id="points">Points</h3>
<p>They proposed &quot;<span style="color:red"><strong><em>Layer-sequential unit-variance (LSUV)</em></strong></span>&quot;&quot; initialization – a simple method for weight initialization for deep net learning.</p>
<ol style="list-style-type: decimal">
<li>First, pre-initialize weights of each convolution or inner-product[内积] layer with orthonormal matrices[正交矩阵].</li>
<li>Second, proceed from the first to the final layer, normalizing the variance of the output of each layer to be equal to one.</li>
</ol>
<p>Performance is evaluated on GoogLeNet, CaffeNet, FitNets and Residual nets and the state-of-the-art, or very close to it, is achieved on the MNIST, CIFAR-10/100 and ImageNet datasets.</p>
<h3 id="background">background</h3>
<blockquote>
<p>History</p>
</blockquote>
<p>After the success of CNNs in IVSRC 2012 (Krizhevsky et al. (2012)), <span style="color:red"><strong><em>initialization with Gaussian noise with mean equal to zero and standard deviation set to 0.01 and adding bias equal to one for some layers become very popular</em></strong></span>.</p>
<ol style="list-style-type: decimal">
<li>It is not possible to train very deep network from scratch with it (<a href="http://arxiv.org/abs/1409.1556">Simonyan &amp; Zisserman (2015)</a>). The problem is caused by the activation (and/or) gradient magnitude in final layers (He et al. (2015)).</li>
<li>If each layer, not properly initialized, scales input by <span class="math inline">\(k\)</span>, the final scale would be <span class="math inline">\(k^L\)</span>, where <span class="math inline">\(L\)</span> is a number of layers. Values of <span class="math inline">\(k &gt; 1\)</span> lead to extremely large values of output layers, <span class="math inline">\(k &lt; 1\)</span> leads to a diminishing signal and gradient.</li>
</ol>
<blockquote>
<p>Obstacles</p>
</blockquote>
<p><span style="color:red"><strong><em>One of the main obstacles preventing the wide adoption of very deep nets is</em></strong></span> :<em>the absence of a general, repeatable and efficient procedure for their end-to-end training</em>.</p>
<p>eg1. VGGNet(Simonyan &amp; Zisserman (2015)) was optimized by a four stage procedure that started by training a network with moderate depth, adding progressively more layers eg2. Romero et al. (2015) stated that deep and thin networks are very hard to train by backpropagation if deeper than five layers, especially with uniform initialization.</p>
<blockquote>
<p>Imporvements:</p>
</blockquote>
<ol style="list-style-type: decimal">
<li><a href="https://arxiv.org/abs/1502.01852">He et al. (2015)</a> showed that it is possible to train the VGGNet in a single optimization run if the network weights are initialized with a specific ReLU-aware initialization. The He et al. (2015) procedure generalizes to the ReLU non-linearity the idea of filter-size dependent initialization, introduced for the linear case by (<a href="http://jmlr.org/proceedings/papers/v9/glorot10a/glorot10a.pdf">Glorot&amp;Bengio (2010)</a>).</li>
<li>Batch normalization (Ioffe &amp; Szegedy (2015)), a technique that inserts layers into the the deep net that transform the output for the batch to be zero mean unit variance, has successfully facilitated training of the twenty-two layer GoogLeNet (Szegedy et al. (2015)).</li>
<li><a href="http://jmlr.org/proceedings/papers/v9/glorot10a/glorot10a.pdf">Glorot &amp; Bengio (2010)</a> proposed a formula for estimating the standard deviation on the basis of the number of input and output channels of the layers under assumption of no non-linearity between layers. Despite invalidity of the assumption, Glorot initialization works well in many applications. There is a blog about xavier, <a href="http://andyljones.tumblr.com/post/110998971763/an-explanation-of-xavier-initialization">An Explanation of Xavier Initialization</a></li>
<li>He et al. (2015) extended this formula to the ReLU (<a href="http://www.jmlr.org/proceedings/papers/v15/glorot11a/glorot11a.pdf">Glorot et al. (2011)</a>) non-linearity and showed its superior performance for ReLU-based nets.</li>
<li>Large weights lead to divergence via updates larger than the initial values, small initial weights do not allow the network to learn since the updates are of the order of 0.0001% per iteration. The optimal scaling for ReLU-net is around 1.4, which is in line with the theoretically derived <span class="math inline">\(\sqrt{2}\)</span> by He et al.(2015).</li>
<li><a href="http://arxiv.org/abs/1412.6558">Sussillo &amp; Abbott (2014)</a> proposed the so called Random walk initialization, RWI, which keeps constant the log of the norms of the backpropagated errors.</li>
<li><a href="https://arxiv.org/abs/1503.02531">Hinton et al. (2014)</a> and <a href="http://arxiv.org/abs/1412.6550">Romero et al. (2015)</a> take another approach to initialization and formulate training as mimicking teacher network predictions (so called knowledge distillation) and internal representations (so called Hints initialization) rather than minimizing the softmax loss.</li>
<li><a href="https://arxiv.org/abs/1507.06228">Srivastava et al. (2015)</a> proposed a LSTM-inspired gating scheme to control information and gradi- ent flow through the network. They trained a 1000-layers MLP network on MNIST. Basically, this kind networks implicitly learns the depth needed for the given task.</li>
<li>Independently, <a href="http://arxiv.org/abs/1312.6120">Saxe et al. (2014)</a> showed that orthonormal matrix initialization works much better for linear networks than Gaussian noise, which is only approximate orthogonal. It also work for networks with non-linearities.</li>
<li>The approach of layer-wise pre-training (<a href="https://papers.nips.cc/paper/3048-greedy-layer-wise-training-of-deep-networks.pdf">Bengio et al. (2007)</a>) which is still useful for multi-layer- perceptron, is not popular for training discriminative convolution networks.</li>
</ol>
<blockquote>
<p>They propose a data-driven weights initialization</p>
</blockquote>
<p>They thus extend the orthonormal initialization <a href="http://arxiv.org/abs/1312.6120">Saxe et al. (2014)</a> to an iterative procedure.</p>
<p><a href="http://arxiv.org/abs/1312.6120">Saxe et al. (2014)</a> can be implemented in two steps: 1. First, fill the weights with Gaussian noise with unit variance. 2. Second, decompose them to orthonormal basis with QR or SVD-decomposition and replace weights with one of the components.</p>
<p>The proposed scheme can be viewed as an <span style="color:red"><strong><em>orthonormal initialization combined with batch normalization performed only on the first mini-batch</em></strong></span>.</p>
<p>The similarity to batch normalization is the unit variance normalization procedure[ 单位方差归一化过程], while initial ortho-normalization[邻正常化] of weights matrices efficiently de-correlates layer activations, which is not done in <a href="http://arxiv.org/abs/1502.03167">Ioffe&amp;Szegedy (2015)</a>.</p>
<ul>
<li>LSUV 正交初始化 算法， <span class="math inline">\(L\)</span>-卷积层或全连层，<span class="math inline">\(W_L\)</span>每一层的权值；<span class="math inline">\(B_L\)</span> its output blob; <span class="math inline">\(Tol_{var}\)</span>差异容差；<span class="math inline">\(T_i\)</span>当前尝试；<span class="math inline">\(T_{max}\)</span>最大的尝试次数， 对于一个有限循环，限制了最大次数，实际情况是永远到不了最大次数。</li>
</ul>
<ol style="list-style-type: decimal">
<li>和<a href="http://arxiv.org/abs/1312.6120">Saxe et al. (2014)</a>一样用正交矩阵初始化网络</li>
<li>对于每一层<span class="math inline">\(L\)</span>,进行 for loop
<ol style="list-style-type: decimal">
<li>当<span class="math inline">\([Var(B_L)-1.0]\ge Tol_{var} \text{and} (T_i&lt;T_{max})\)</span>, 执行
<ol style="list-style-type: decimal">
<li>对每一个mini_batch做forward pass</li>
<li>计算 <span class="math inline">\(Var(B_L)\)</span></li>
<li><span class="math inline">\(W_L=W_L/\sqrt{Var(B_L)}\)</span></li>
</ol></li>
<li>end while</li>
</ol></li>
<li>end for</li>
</ol>
<h3 id="conclusions">CONCLUSIONS</h3>
<p>LSUV, layer sequential uniform variance, a simple strategy for weight initialization for deep net learning, is proposed. We have showed that the LSUV initialization, described fully in six lines of pseudocode, is as good as complex learning schemes which need, for instance, auxiliary nets.</p>
<p>The LSUV initialization allows learning of very deep nets via standard SGD, is fast, and leads to (near) state-of-the-art results on MNIST, CIFAR, ImageNet datasets, outperforming the sophisti- cated systems designed specifically for very deep nets such as FitNets( <a href="http://arxiv.org/abs/1412.6550">Romero et al. (2015)</a>) and Highway( <a href="http://arxiv.org/abs/1507.06228">Srivastava et al. (2015)</a>). The proposed initialization works well with different activation functions.</p>
<p>Our experiments <span style="color:red"><strong><em>confirm the finding of Romero et al. (2015) that very thin, thus fast and low in parameters, but deep networks obtain comparable or even better performance than wider, but shallower ones</em></strong></span>.</p>
</body>
</html>
