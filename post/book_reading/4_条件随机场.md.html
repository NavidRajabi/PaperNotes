<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<h1 id="条件随机场crf">条件随机场(CRF)</h1>
<h2 id="马尔可夫链">马尔可夫链</h2>
<p>比如：一个人想从A出发到达目的地F，然后中间必须依次路过B,C, D, E，于是就有这样一个状态：</p>
<pre><code>若想到达B，则必须经过A；
若想到达C，则必须经过A, B；
以此类推，最终
若想到达F，则必须经过A,B,C,D,E。</code></pre>
<p>如果把上面的状态写成一个序列的话，那就是：{到达A, 到达B, 到达c, ..., 到达F}，而且很明显，状态序列的每个状态值取决于前面的状态是否已经满足。</p>
于是，像这样，“状态序列的每个状态值取决于前面<font style="color:red">有限个状态</font>”的状态序列就是<strong>马尔可夫链</strong>。这就包括“一个人想到达目的地C，那就得先从A处开车并在B处买早餐”这样的情况，这样一来，先到A还是先到B就无所谓了(无论是先去麦当劳买早餐再去开车，还是先开车然后在去麦当劳买早餐都行)，只要A和B同时满足就好. 总之，马尔科夫链中的各个元素既可以是一对一，也可以是一对多，当然也可以是多对一或多对多，参照下图：
<center>
<img src="http://img.blog.csdn.net/20160525153434989"></img>
</center>
<h2 id="隐马尔可夫模型hmm">隐马尔可夫模型(HMM)</h2>
<p>还用上面一个人从A到F的例子。 但这里需要把条件和内容改一改：</p>
<pre><code>条件更改：
    此人想今天逛完A, B,C, D, E, F这几处，但是他想先逛哪个后逛哪个我们不知道。
内容添加：
    此人每到达一处，他就会买一个礼物带给你，可这家伙逛的太兴奋了，于是乎带给你的礼物有重复的，因此，最后你会有这样的观测结果：{礼物1，礼物2，礼物1，礼物3，礼物2，礼物2} (于是还是不知道他想先逛哪个后逛哪个)。</code></pre>
<p>结果，我们不知道状态序列(我们不知道他逛的顺序)，但是知道观测序列，且每个观测一定是一个状态生成的(礼物一定是他到地方才能买)。<font style="color:red">因此这个例子就是在描述：一个不知道状态序列(即马尔科夫链)，却知道根据各个状态生成的一个观测随机序列的过程，而这个过程就是隐马尔可夫模型。</font> 用数学定义说明的话就是：隐马尔可夫模型描述由一个隐藏的马尔可夫链随机生成的不可观测的状态序列，再由各个状态生成一个观测而产生观测随机序列的过程。</p>
<h3 id="hmm的局限性">HMM的局限性</h3>
<ul>
<li>该模型定义的是联合概率，必须列举所有观察序列的可能值，而这对多数领域来说是比较困难的。</li>
<li>基于观察序列中的每个元素都相互条件独立。即：在任何时刻观察值仅仅与状态序列中的一个状态有关。而大多数现实世界中的真是观察序列是有多个相互作用的特征和观察序列中较长范围内的元素之间的依赖而形成的。</li>
</ul>
<h3 id="产生式模型和判别式模型">产生式模型和判别式模型</h3>
<p>如果你已经了解HMM的话就会知道：HMM中需要计算的概率是“观测序列(输入)和状态序列(输出)的联合概率”，即P(状态序列, 观测序列)，即状态序列和观测序列同时发生的概率。 于是乎对于输入<span class="math inline">\(x\)</span>(或者说观察序列)和输出<span class="math inline">\(y\)</span>(或者说标记序列)： - 构建它们的联合概率分布<span class="math inline">\(P(y,x)\)</span>的模型就是产生式模型，该模型可以根据联合概率生成样本，如：HMM, BNs, MRF。 - 构建它们的条件概率分布<span class="math inline">\(P(y | x)\)</span>的模型就是判别式模型，因为没有y的知识，所以无法生成样本，只能判断分类，如：CRF, SVM, MEMM。 - 产生式模型：无穷样本--&gt; 概率密度模型=产生模型--&gt; 预测 - 判别式模型：有限样本--&gt; 判别函数=预测模型--&gt; 预测</p>
<p>例子, 对四个元素：(1, 0),(1, 0), (2, 0), (2, 1). - 产生式模型：求 <span class="math inline">\(P(x, y)\)</span>. 因为上面四个元素中(1,0)有两个，所以 P(1, 0) = 2/4 = 1/2. 同理：p(1, 1) =0, p(2, 0) = 1/4, p(2, 1) = 1/4. - 判别式模型：求<span class="math inline">\(P(y|x)\)</span>. 因为对上面四个元素，若x=1，那一定有y=0，所以 P(0|1) =1. 同理：p(1|1) =0, p(0|2) = 1/2, p(1|2) = 1/2.</p>
<p>产生式模型：从统计的角度表示数据的分布情况，能够反映同类数据本身的相似度，不关心判别边界。 - 优点： (1) 实际上带的信息比判别模型丰富，研究单类问题比判别模型灵活性强; (2) 能更充分的利用先验知识; (3) 模型可以通过增量学习得到 - 缺点： (1) 学习过程比较复杂; (2) 在目标分类问题中易产生较大的错误率</p>
<p>判别式模型：寻找不同类别之间的最优分类面，反映的是异类数据之间的差异。 - 优点： (1) 分类边界更灵活，比使用纯概率方法或生产模型得到的更高级。(2) 能清晰的分辨出多类或某一类与其他类之间的差异特征; (3) 在聚类、viewpointchanges、parital occlusion and scale variations 中的效果较好; (4) 适用于较多类别的识别 - 缺点： (1) 不能反映训练数据本身的特征; (2) 能力有限，可以告诉你是1还是2，但没有办法把整个场景描述出来.</p>
<h2 id="条件随机场crf-1">条件随机场(CRF)</h2>
<p>假设你基(姬)友给了你ta一天生活的照片(这些照片是排好序的)，然后让你给这些照片打上标签(Tag)，比如：这张在吃饭，这张在睡觉，这张在唱歌，那么你该怎么做呢？ 如果用HMM的思想，那就是：</p>
<pre><code>我手上已经有了观测集合(一天的照片)，然后让我求该观测集合对应的状态集合(打Tag)。OK，我开始打Tag了，嗯....这张照片黑乎乎的，那可能在睡觉；这张照片七彩斑斓的，是在KVM吧，那是在唱歌；这张....这张张着大嘴的特写是什么鬼？在吃饭？在唱歌？嗯....看不懂。问问ta好了，(转头)，诶？ta人呢？我特！！算了，胡乱给一个！在狼嚎(唱歌)！嗯，就这么愉快的决定了。</code></pre>
<p>于是乎像上面这个例子描述的这样，虽然HMM最终会给出一个结论，但因为HMM的“基于观察序列中的每个元素都相互条件独立”的缺陷，导致其在给某个观测“配对”状态时会毫无根据。</p>
<p>不过我们是人，我们才不会傻乎乎的胡乱猜，那在这样的情况下我们怎么做？答案大家都知道：我们会看看前一张图片是什么，如果前一张图片是在KVM，那这张就很有可能在唱歌；如果前一张是在厨房，那这一张就很有可能在张嘴吃饭。根据这个例子，我们可以看出，<font style="color:red">在给某个输出(观测/特征)找其输入(产生“观测/特征”的状态)时，不能不考虑上下文(紧挨着该特征的特征)，否则准确性会大大降低</font>。 而这种“HMM强化版的思想”就是CRF了.</p>
<h2 id="概率无向图模型马尔可夫随机场">概率无向图模型(马尔可夫随机场)</h2>
<p>其实这个又叫做马尔可夫随机场(MRF)，而这里需要讲解的条件随机场就和其有脱不开的关系。 ### 模型定义 首先是无向图。那什么是无向图呢？ 其实无向图就是指没有方向的图....我没有开玩笑，无向图真是这玩意。只不过这里我们研究的无向图的细节是：这个图是有节点和连接节点的边组成的集合，像下面这样： <img src="http://img.blog.csdn.net/20160525154050863" /></p>
<p>然后上面的节点表示一个个随机变量，边表示随机变量之间的依赖关系。为了方便用数学语言描述，我们把节点和边分别记作<span class="math inline">\(v\)</span>和<span class="math inline">\(e\)</span>，节点和边的集合分别记作<span class="math inline">\(V\)</span>和<span class="math inline">\(E\)</span>，于是图就记作<span class="math inline">\(G=(V, E)\)</span>。无向图清楚了，那什么是概率无向图模型？是这样。<font style="color:red">假设有联合概率分布<span class="math inline">\(P(Y)\)</span>，<span class="math inline">\(Y\)</span>是属于某个集合的一组随机变量。如果用无向图<span class="math inline">\(G=(V, E)\)</span>表示概率分布<span class="math inline">\(p(Y)\)</span>的话，那在图<span class="math inline">\(G\)</span>中，节点<span class="math inline">\(v\in V\)</span>就表示一个随机变量<span class="math inline">\(Y_v\)</span>, <span class="math inline">\(Y = (Y_v)v\in V\)</span>;边<span class="math inline">\(e\in E\)</span>表示随机变量之间的概率依赖关系。而如果<span class="math inline">\(P(Y)\)</span>满足成对、局部或全局马尔可夫性的话，就称此联合概率分布为概率无向图模型，或马尔可夫随机场。</font></p>
<p>那么问题来了：什么是“成对、局部、全局马尔可夫性”。 1. 成对马尔可夫性： 设<span class="math inline">\(u\)</span>和<span class="math inline">\(v\)</span>是无向图<span class="math inline">\(G\)</span>中任意两个没有边连接的节点，节点<span class="math inline">\(u\)</span>和<span class="math inline">\(v\)</span>分别对应随机变量<span class="math inline">\(Y_u\)</span>和<span class="math inline">\(Y_v\)</span>。其他所有节点为O，对应的随机变量是<span class="math inline">\(Y_o\)</span>。成对马尔可夫性是指给定随机变量组<span class="math inline">\(Y_o\)</span>的条件下随机变量<span class="math inline">\(Y_u\)</span>和<span class="math inline">\(Y_v\)</span>是条件独立的，即 $ P(Y_u,Y_v|Y_o) = P(Y_u|Y_o)P(Y_v|Y_o)$. 2. 局部马尔可夫性: <span class="math inline">\(v\in V\)</span>是无向图<span class="math inline">\(G\)</span>中任意一个节点，<span class="math inline">\(W\)</span>是与<span class="math inline">\(v\)</span>有边连接的所有节点，<span class="math inline">\(O\)</span>是<span class="math inline">\(v\)</span>、<span class="math inline">\(W\)</span>以外的其他所有节点。<span class="math inline">\(v\)</span>表示随机变量是<span class="math inline">\(Y_v\)</span>，<span class="math inline">\(W\)</span>表示的随机变量组是<span class="math inline">\(Y_W\)</span>，<span class="math inline">\(O\)</span>表示的随机变量组是<span class="math inline">\(Y_o\)</span>。局部马尔可夫性是指在给定随机变量组<span class="math inline">\(Y_W\)</span>的条件下随机变量<span class="math inline">\(Y_v\)</span>与随机变量组<span class="math inline">\(Y_o\)</span>是独立的，即: <span class="math inline">\(P(Y_u,Y_v|Y_w) = P(Y_v|Y_w)P(Y_o|Y_w)\)</span>. 在 <span class="math inline">\(P(Y_o|Y_W)&gt; 0\)</span>时，等价地，<span class="math inline">\((Y_v|Y_w)= P(Y_v|Y_w, Y_o)\)</span>. 3. 全局马尔可夫性： 设节点集合<span class="math inline">\(A\)</span>，<span class="math inline">\(B\)</span>是在无向图<span class="math inline">\(G\)</span>中被节点集合<span class="math inline">\(C\)</span>分开的任意节点集合，如下图所示 <img src="http://img.blog.csdn.net/20160525154055653" /> 节点集合<span class="math inline">\(A\)</span>，<span class="math inline">\(B\)</span>和<span class="math inline">\(C\)</span>所对应的随机变量组分别是<span class="math inline">\(Y_A\)</span>，<span class="math inline">\(Y_B\)</span>，<span class="math inline">\(Y_C\)</span>。全局马尔可夫性是指给定随机变量组<span class="math inline">\(Y_C\)</span>条件下随机变量组<span class="math inline">\(Y_A\)</span>和<span class="math inline">\(Y_B\)</span>是条件独立的，即: <span class="math inline">\(P(Y_A,Y_B| Y_C) = P(Y_A|Y_C)P(Y_B|Y_C)\)</span>.</p>
<p>给定概率无向图模型，设其无向图为<span class="math inline">\(G\)</span>，<span class="math inline">\(C\)</span>为<span class="math inline">\(G\)</span>上的最大团，<span class="math inline">\(Y_C\)</span>表示<span class="math inline">\(C\)</span>对应的随机变量。那么概率无向图模型的联合概率分布<span class="math inline">\(P(Y)\)</span>可写作图中所有最大团<span class="math inline">\(C\)</span>上的函数<span class="math inline">\(\Psi C(Y_C)\)</span>的乘积形式，即： <span class="math display">\[
P(Y)=\frac{1}{Z}\prod_c \Psi_c(Y_c)
\]</span> 其中，Z是规范化因子 <span class="math inline">\(Z=\sum_Y\prod_c \Psi_c(Y_c)\)</span>. 规范化因子保证<span class="math inline">\(P(Y)\)</span>构成一个概率分布。函数函数<span class="math inline">\(\Psi C(Y_C)\)</span>称为势函数。因为要求势函数<span class="math inline">\(\Psi C(Y_C)\)</span>是严格正的，于是通常定义为指数函数： <span class="math display">\[
\Psi_c(Y_c)=\exp {-E(Y_c)}
\]</span> 概率无向图模型的因子分解由下述定理来保证。</p>
<h2 id="hammersley-clifford定理">Hammersley-Clifford定理</h2>
<p>概率无向图模型的联合概率分布P(Y)可以表示为如下形式： <span class="math display">\[
P(Y)=\frac{1}{Z}\prod_c \Psi_c (Y_c), \ \ Z=\sum_Y\prod_c \Psi_c (Y_c)
\]</span> 其中，<span class="math inline">\(C\)</span>是无向图的最大团，<span class="math inline">\(Y_C\)</span>是<span class="math inline">\(C\)</span>的节点对应的随机变量，<span class="math inline">\(\Psi C(Y_C)\)</span>是<span class="math inline">\(C\)</span>上定义的严格正函数，乘积是在无向图所有的最大团上进行的 。</p>
<p>我们再回顾下马尔可夫随机场(MRF)，即概率无向图模型。 马尔可夫随机场对应一个无向图。这个无向图上的每个节点对应一个随机变量，节点之间的边表示节点对应的随机变量之间有概率依赖关系。(因此，MRF的结构其本质反映了我们的先验知识 -- 哪些变量之间有依赖关系需要考虑，哪些可以忽略。) 然后我们再看看什么是条件随机场(CRF)。 其实弄懂了MRF之后，CRF就很好理解了，因为如果给定的MRF中每个随机变量下面还有观察值，那么我们的目标就是要确定给定观察集合下的MRF分布，也就是条件分布，而这种条件分布就是条件随机场。 简单的说，条件随机场(CRF)类似于MRF，只不过CRF比MRF多了一个观察集合，或者说，CRF本质上就是给定了观察值集合的MRF。 下面给出定义。 ## CRF定义 定义1：条件随机场 设<span class="math inline">\(G=(V,E)\)</span>是一个无向图，<span class="math inline">\(Y={Y_v|v\in V}\)</span>是以<span class="math inline">\(G\)</span>中节点<span class="math inline">\(v\)</span>为索引的随机变量Yv构成的集合。在给定<span class="math inline">\(X\)</span>的条件下，如果每个随机变量<span class="math inline">\(Y_v\)</span>服从马尔可夫性，即 <span class="math display">\[P(Y_v|X, Y_w, w\ne v)=P(Y_v|X, Y_w, w\sim v)\]</span>. 那么条件概率分布P(Y|X)就是一个条件随机场。上式中的<span class="math inline">\(w \sim v\)</span>表示在图<span class="math inline">\(G=(V, E)\)</span>中与节点<span class="math inline">\(v\)</span>有边连接的所有节点，<span class="math inline">\(w\ne v\)</span>表示<span class="math inline">\(v\)</span>以外的所有节点，<span class="math inline">\(Y_v,Y_u\)</span>, <span class="math inline">\(Y_w\)</span>为<span class="math inline">\(w\)</span>对节点<span class="math inline">\(v\)</span>，<span class="math inline">\(u\)</span>，<span class="math inline">\(w\)</span>对应的随机变量。</p>
<p>需要说明的是：在定义中并没有要求X和Y具有相同的结构（不过，在现实中一般假设X和Y有相同的图结构），这里主要考虑无向图G=(V,E)为如图11.4与11.5所示的线性链的情况： <img src="http://img.blog.csdn.net/20160525154113763" /></p>
<p>即：<span class="math inline">\(G=( V={1,2, ..., n}, E={(i, i+1)}) , i = 1, 2, ..., n-1\)</span>。在此情况下：<span class="math inline">\(X =(X_1, X_2, ..., X_n), Y = (Y_1, Y_2, ..., Y_n)\)</span>，最大团是相邻两个结点的集合。根据上面的情况，线性链条件随机场有如下定义。</p>
<h3 id="定义2线性链条件随机场">定义2：线性链条件随机场</h3>
<p>设<span class="math inline">\(X = (X_1, X_2,..., X_n), Y = (Y_1, Y_2, ..., Y_n)\)</span>均为线性链表示的随机变量序列，若在给定随机变量序列X的条件下，随机变量序列Y的条件概率分布P(Y|X)构成条件随机场，即满足马尔可夫性(见本文最开始的“模型定义”部分)： <span class="math display">\[
P(Yi| X, Y1, ..., Yi-1, Yi+1, ...., Yn)= P(Yi | X, Yi-1, Yi+1), i= 1, 2, ..., n
\]</span> 其中，在i=1和n时只考虑单边。则称<span class="math inline">\(P(Y|X)\)</span>为线性链条件随机场。　在标注问题中，X表示输入观测序列，Y表示对应的输出标记序列或状态序列。</p>
<h2 id="条件随机场的参数化形式">条件随机场的参数化形式</h2>
<p>上面有定义了，那下面就需要用更精确的方程式来表示线性链条件随机场<span class="math inline">\(P(Y|X)\)</span>，即：给出线性链条件随机场的参数化形式。先给出定义吧。</p>
<p>定义：线性链条件随机场的参数化形式 设<span class="math inline">\(P(Y|X)\)</span>为线性链条件随机场，则在随机变量<span class="math inline">\(X\)</span>取值为<span class="math inline">\(x\)</span>的条件下，随机变量<span class="math inline">\(Y\)</span>取值为<span class="math inline">\(y\)</span>的条件概率具有如下形式： <span class="math display">\[
P(y|x)=\frac{1}{Z(x)}\exp (\sum_{i,k}\lambda_k t_k (y_{i-1}, y_i, x, i)+\sum_{i,l}\mu_l s_l(y_i, x, i))
\]</span> 其中，　<span class="math inline">\(Z(x)=\sum_y \exp (\sum_{i,k}\lambda_k t_k (y_{i-1}, y_i, x, i)+\sum_{i,l}\mu_l s_L(y_i, x, i))\)</span> 式中，<span class="math inline">\(t_k\)</span>和<span class="math inline">\(s_l\)</span>是特征函数，<span class="math inline">\(\lambda k\)</span>和<span class="math inline">\(\mu l\)</span>是对应的权值。<span class="math inline">\(Z(x)\)</span>是规范化因子，求和时在所有可能的输出序列上进行的。</p>
<h2 id="条件随机场的简化形式">条件随机场的简化形式</h2>
<p>虽然上面已经可以表达条件随机场，但写起来还是蛮复杂的，于是为了让式子更简单，就有了条件随机场的简化形式，即: 设有<span class="math inline">\(K_1\)</span>个转移贴纸，<span class="math inline">\(K_2\)</span>个状态特征，<span class="math inline">\(K=K_1+K_2\)</span>，记： <span class="math display">\[
f_k(y_{i-1},y_i, x, i)=\begin{cases}t_k(y_{i-1},y_i, x , i), k=1,2,\cdots, K_1\\ s_l(y_i, x, i), k=K_1+l;l=1,2,\cdots, K_2\end{cases}
\]</span> 然后，对转移与装填特征在各个位置<span class="math inline">\(i\)</span>求和，记做 <span class="math display">\[
f_k(y,x)=\sum_{i=1}^n f_k(y_{i-1},y_i, x,i),k=1,2,\cdots, K
\]</span> 用<span class="math inline">\(w_k\)</span>表示特征<span class="math inline">\(f_k(y,x)\)</span>的权值，即：<span class="math inline">\(w_k=\begin{cases}\lambda_k, k=1,2,\cdots, K\\\mu_l, k=K_1+l;l=1,2,\cdots, K_2\end{cases}\)</span> 于是，条件随机场可表示为: <span class="math display">\[
P(y|x)=\frac{1}{Z(x)}\exp \sum_{k=1}^K w_k f_k(y,x)
\]</span> <span class="math display">\[
Z(x)=\sum_y \exp \sum_{k=1}^K w_k f_k (y,x)
\]</span> 若以<span class="math inline">\(w\)</span>表示权值向量，即<span class="math inline">\(w=(w_1,w_2,\cdots, w_k)^T\)</span>. 以<span class="math inline">\(F(y, x)\)</span>表示全局特征向量，即 <span class="math inline">\(F(y,x)=(f_1(y,x),f_2(y,x),\cdots, f_k(y,x))^T\)</span></p>
<p>则条件随机场可以写成向量<span class="math inline">\(w\)</span>与<span class="math inline">\(F(y, x)\)</span>的内积的形势： <span class="math display">\[
\begin{cases}P_w(y|x)=\frac{\exp (w . F(y,x))}{Z_w(x)}\\Z_w(x)=\sum_y \exp(w. F(y,x))\end{cases}
\]</span></p>
<h2 id="条件随机场的矩阵形式">条件随机场的矩阵形式</h2>
<p>假设<span class="math inline">\(P_w(y|x)\)</span>是由上式给出的线性链条件随机场，表示对给定观测序列<span class="math inline">\(x\)</span>，相应的标记序列<span class="math inline">\(y\)</span>的条件概率。引进特殊的起点和终点状态标记<span class="math inline">\(y_0 = \text{start},y_{n+1} = \text{stop}\)</span>，这时<span class="math inline">\(P_w(y|x)\)</span> 可以通过矩阵形式表示。</p>
<p>对观测序列x的每一个位置<span class="math inline">\(i=1, 2,..., n+1\)</span>，定义一个<span class="math inline">\(m\)</span>阶矩阵(<span class="math inline">\(m\)</span>是标记<span class="math inline">\(y_i\)</span>取值的个数) <span class="math display">\[
\begin{cases}
M_i(x)=[M_i(y_{i-1},y_i|x)]\\
M_i(y_{i-1},y_i|x)=\exp (W_i(y_{i-1},y_i|x))\\
W_i(y_{i-1},y_i|x)=\sum_{i=1}^Kw_k f_k(y_{i-1},y_i,x,i)
\end{cases}
\]</span> 这样给定观测序列<span class="math inline">\(x\)</span>，标记序列<span class="math inline">\(y\)</span>的非规范化概率可以通过<span class="math inline">\(n+1\)</span>个矩阵的乘积 <span class="math inline">\(\prod_{i=1}^{n+1}M_i(y_{i-1},y_i|x)\)</span>表示。</p>
<p>于是，条件概率<span class="math inline">\(P_w(y|x)\)</span>是 <span class="math display">\[
P_w(y|x)=\frac{1}{Z_w(x)}\prod_{i=1}^{n+1}M_i(y_{i-1},y_i|x)
\]</span> 其中，<span class="math inline">\(Z_w(x)\)</span>为规范化因子，是<span class="math inline">\(n+1\)</span>个矩阵的乘积的(start,stop)元素：<span class="math inline">\(Z_w(x)=(M_1(x),M_2(x),M_3(x), \cdots, M_{n+1}(x))_{start, stop}\)</span></p>
<p>注意，<span class="math inline">\(y_0= start\)</span>，<span class="math inline">\(y_{n+1} = stop\)</span>表示开始状态与终止状态，规范化因子<span class="math inline">\(Z_w(x)\)</span>是以start为起点stop为重点通过状态的所有路径<span class="math inline">\(y_1, y_2, \cdots, y_n\)</span>的非规范化概率 <span class="math inline">\(\prod_{i=1}^{n+1}M_i(y_{i-1},y_i|x)\)</span> 之和。</p>
<h1 id="reference">Reference</h1>
<ul>
<li>http://blog.csdn.net/xueyingxue001/article/details/51498968</li>
</ul>
</body>
</html>
